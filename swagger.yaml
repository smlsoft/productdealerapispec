openapi: 3.0.0
info:
  description: "This is a Spec For SML Product Dealer."
  version: 1.0.2
  title: Product Dealer API
  contact:
    email: toe@smlsoft.com
tags:
  - name: Product
  - name: Dealer
  - name: Product Dealer
  - name: Transaction
    description: Sync transaction from SMLAccount
servers:
  - url: api.domain.com
paths:
  /product:
    post:
      tags:
        - Product
      summary: Add new product
      operationId: addProduct
      description: for add product to sync to dealer
      requestBody:
        $ref: "#/components/requestBodies/Product"
      responses:
        "200":
          description: "Success"
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ApiResponse'
        "400":
          description: "Bad request"
      security:
        - bearer_token: []
    get:
      tags:
        - Product
      summary: "List product."
      description: for list product in system
      operationId: listProduct
      responses:
        "200":
          description: List of product object
          content:
            application/json:
              schema:
                type: object
                allOf:
                   - $ref: "#/components/schemas/Product"
                properties:
                  dealers:
                    type: array
                    description: ผู้แทนจำหน่าย
                    items:
                      $ref: "#/components/schemas/ProductDealerSync"
        "401":
          $ref: "#/components/responses/401"
      security:
        - bearer_token: []
  /product/{code}:
    get:
      tags:
        - Product
      parameters:
        - name: code
          in: path
          description: code of product to return
          required: true
          schema:
            type: string
      summary: "Get product information by product code"
      operationId: getProduct
      description: "get product information by code"
      responses:
        "200":
          description: "Success"
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Product'
        "400":
          description: "Bad request"
      security:
        - bearer_token: []          
    put:
      tags:
        - Product
      parameters:
        - name: code
          in: path
          description: code of product to return
          required: true
          schema:
            type: integer
            format: int64
      summary: "Update an existing product"
      operationId: updateProduct
      description: "for update product sync to dealer"
      requestBody:
        $ref: "#/components/requestBodies/Product"
      responses:
        "200":
          description: "Success"
        "400":
          description: "Bad request"
      security:
        - bearer_token: []          
    delete:
      parameters:
        - name: code
          in: path
          description: code of product to return
          required: true
          schema:
            type: integer
            format: int64
      tags:
        - Product
      summary: "Remove product"
      operationId: deleteProduct
      description: "for delete product sync to dealer"
      responses:
        "200":
          description: "Success"
        "400":
          description: "Bad request"
      security:
        - bearer_token: []          
  /dealer:
    post:
      tags:
        - Dealer
      summary: Create new dealer
      operationId: addDealer
      description: "for add new dealer"
      requestBody:
        $ref: '#/components/requestBodies/Dealer'
      responses:
        "200":
          description: "Success"
        "400":
          description: "Bad request"
      security:
        - bearer_token: []          
    get:
      tags:
        - Dealer
      operationId: listDealer
      summary: List dealer
      description: "for list all dealer."
      requestBody:
        $ref: '#/components/requestBodies/Dealer'
      responses:
        "200":
          description: "Success"
        "400":
          description: "Bad request"
      security:
        - bearer_token: []          
  /dealer/{code}:
    get:
      tags:
        - Dealer
      operationId: getDealer
      summary: Get dealer by code.
      description: "for get dealer by dealer code."
      parameters:
        - name: code
          in: path
          description: code of dealer to return
          required: true
          schema:
            type: string
      responses:
        "200":
          description: "Success"
        "400":
          description: "Bad request"
      security:
        - bearer_token: []          
    put:
      tags:
        - Dealer
      operationId: updateDealer
      summary: Update an existing dealer
      description: "for add product sync to dealer"
      parameters:
        - name: code
          in: path
          description: code of product to update
          required: true
          schema:
            type: string
      responses:
        "200":
          description: "Success"
        "400":
          description: "Bad request"
      security:
        - bearer_token: []          
    delete:
      tags:
        - Dealer
      operationId: deleteDealer
      summary: Delete a dealer
      description: "for add product sync to dealer"
      parameters:
        - name: code
          in: path
          description: code of dealer to delete
          required: true
          schema:
            type: string
      responses:
        "200":
          description: "Success"
        "400":
          description: "Bad request"
      security:
        - bearer_token: []          
  /productdealer:
    put:
      tags:
        - Product Dealer
      operationId: setProductDealer
      summary: Set product for dealer
      description: set a product for dealer
      requestBody:
        $ref: '#/components/requestBodies/ProductDealer'
      responses:
        "200":
          description: "Success"
        "400":
          description: "Bad request"
      security:
        - bearer_token: []      
  /saleinvoice:
    post:
      tags:
        - Transaction
      operationId: syncSaleInvoice
      summary: Sync sale invoice(SI)
      description: Sync sale invoice(SI)
      requestBody:
        $ref: '#/components/requestBodies/SaleInvoice'
      responses:
        "201":
          $ref: "#/components/responses/201"
        "400":
          $ref: "#/components/responses/400"
  /salecreditnote:
    post:
      tags:
        - Transaction
      operationId: syncSaleCreditNote
      summary: Sync sale credit note(CN)
      description: Sync sale credit note(CN))
      requestBody:
        $ref: '#/components/requestBodies/SaleCreditNote'
      responses:
        "201":
          $ref: "#/components/responses/201"
        "400":
          $ref: "#/components/responses/400"
  /saledebitnote:
    post:
      tags:
        - Transaction
      operationId: syncSaleDebitNote
      summary: Sync sale debit note(DN)
      description: Sync sale debit note(DN)
      requestBody:
        $ref: '#/components/requestBodies/SaleDebitNote'
      responses:
        "201":
          $ref: "#/components/responses/201"
        "400":
          $ref: "#/components/responses/400"
  /purchaseinvoice:
    post:
      tags:
        - Transaction
      operationId: syncPurchaseInvoice
      summary: Sync purchase invoice(PU)
      description: Sync purchase invoice(PU)
      requestBody:
        $ref: '#/components/requestBodies/PurchaseInvoice'
      responses:
        "201":
          $ref: "#/components/responses/201"
        "400":
          $ref: "#/components/responses/400"
  /purchasecreditnote:
    post:
      tags:
        - Transaction
      operationId: syncPurchaseCreditNote
      summary: Sync purchase credit note
      description: Sync purchase credit note
      requestBody:
        $ref: '#/components/requestBodies/PurchaseCreditNote'
      responses:
        "201":
          $ref: "#/components/responses/201"
        "400":
          $ref: "#/components/responses/400"
  /purchasedebitnote:
    post:
      tags:
        - Transaction
      operationId: syncPurchaseDebitNote
      summary: Sync purchase debit note
      description: Sync purchase debit note
      requestBody:
        $ref: '#/components/requestBodies/PurchaseDebitNote'
      responses:
        "201":
          $ref: "#/components/responses/201"
        "400":
          $ref: "#/components/responses/400"
  /purchaseorder:
    post:
      tags:
        - Transaction
      operationId: syncPurchaseOrder
      summary: Sync purchase order(PO)
      description: Sync purchase order(PO)
      requestBody:
        $ref: '#/components/requestBodies/PurchaseOrder'
      responses:
        "201":
          $ref: "#/components/responses/201"
        "400":
          $ref: "#/components/responses/400"
components:
  requestBodies:
    Product:
      content:
         application/json:
          schema:
            type: object
            allOf:
               - $ref: "#/components/schemas/Product"
            properties:
              dealers:
                type: array
                description: ผู้แทนจำหน่าย
                items:
                  $ref: "#/components/schemas/ProductDealerSync"
          example:
           code: "IC0001"
           name_1: "Product Name 1"
           unit_cost: "PCS"
           item_type: 0
           tax_type: 0
           units:
             - code: "PCS"
               stand_value: 1
               divide_value: 1
               ratio: 1
               row_order: 0
               line_number: 0
           dealers:
             - dealercode: "204900001"
               issync: true
    Dealer:
      content:
         application/json:
          schema:
            $ref: "#/components/schemas/Dealer"
    ProductDealer:
      content:
        application/json:
          schema:
            type: array
            items:
              $ref: "#/components/schemas/ProductDealer"
    SaleInvoice:
      content:
        application/json:
          schema:
            $ref: "#/components/schemas/SaleInvoiceTransaction"
    SaleCreditNote:
      content:
        application/json:
          schema:
            $ref: "#/components/schemas/TransactionWithPayment"
    SaleDebitNote:
      content:
        application/json:
          schema:
            $ref: "#/components/schemas/TransactionWithPayment"
    PurchaseInvoice:
      content:
        application/json:
          schema:
            $ref: "#/components/schemas/TransactionWithPayment"
    PurchaseCreditNote:
      content:
        application/json:
          schema:
            $ref: "#/components/schemas/TransactionWithPayment"
    PurchaseDebitNote:
      content:
        application/json:
          schema:
            $ref: "#/components/schemas/TransactionWithPayment"
    PurchaseOrder:
      content:
        application/json:
          schema:
            $ref: "#/components/schemas/Transaction"
  responses:
    '201':
      description: Created success
      content:
        application/json:
          schema:
            $ref: "#/components/schemas/ApiResponse"
          example:
            message: Created success
            success: true
    '400':
      description: Bad request
      content:
        application/json:
          schema:
            $ref: "#/components/schemas/ApiResponse"
          example:
            message: Bad request
            success: false
    '401':
      description: Unauthorize
      content:
        application/json:
          schema:
            $ref: "#/components/schemas/ApiResponse"
          example:
            message: Unauthorize
            success: false
    '500':
      description: Internal server error
      content:
        application/json:
          schema:
            $ref: "#/components/schemas/ApiResponse"
          example:
            code: 99999
            message: Internal server error
            success: false
  schemas:
    ApiResponse:
      type: object
      properties:
        code:
          type: integer
          format: int32
        message:
          type: string
        success:
          type: boolean        
    Product:
      type: object
      properties:
        code:
          type: string
          description: รหัสสินค้า
          maxLength: 25
        name_1:
          type: string
          description: ชื่อสินค้า
          maxLength: 255
        name_eng_1:
          type: string
          description: ชื่อ (ภาษาอังกฤษ)
          maxLength: 255
        short_name:
          type: string
          description: ชื่อสินค้าแบบย่อ
          maxLength: 255
        unit_cost:
          type: string
          description: รหัสหน่วยนับ(ต้นทุน)
          maxLength: 25          
        item_category:
          type: string
          description: รหัสหมวดสินค้า
          maxLength: 25
        group_main:
          type: string
          description: รหัสกลุ่มสินค้าหลัก
          maxLength: 25
        group_sub:
          type: string
          description: รหัสกลุ่มสินค้าย่อย
          maxLength: 25
        group_sub2:
          type: string
          description: รหัสกลุ่มสินค้าย่อย 2
          maxLength: 25
        item_class:
          type: string
          description: รหัสระดับสินค้า
          maxLength: 25
        item_pattern:
          type: string
          description: รหัสรูปแบบสินค้า
          maxLength: 25
        item_brand:
          type: string
          description: รหัสยี่ห้อ
          maxLength: 25
        item_design:
          type: string
          description: รหัสรูปทรง
          maxLength: 25
        item_grade:
          type: string
          description: รหัสเกรดสินค้า          
          maxLength: 25
        item_model:
          type: string
          description: รหัสรุ่นสินค้า          
          maxLength: 25
        code_old:
          type: string
          maxLength: 25
          description: รหัสสินค้าเดิม
        tax_type:
          type: integer
          description: ประเภทภาษี (0=ภาษีมูลค่าเพิ่ม, 1=ยกเว้นภาษี)
        ic_serial_no:
          type: integer
          description: สินค้ามี Serial (0=ไม่มี, 1=มี)
        account_code_1:
          type: string
          description: รหัสผังบัญชีสินค้า
          maxLength: 25
        account_code_2:
          type: string
          description: รหัสผังบัญชีต้่นทุน
          maxLength: 25
        account_code_3:
          type: string
          description: รหัสผังบัญชีรายได้
          maxLength: 25
        account_code_4:
          type: string
          description: รหัสผังบัญชีรับคืน
          maxLength: 25
        last_update_date_time:
          type: string
          format: date-time
          description: The date and time of the last update.     
        units:
          type: array
          items:
            $ref: "#/components/schemas/ProductUnit"
        barcodes:
          type: array
          items:
            $ref: "#/components/schemas/Barcode"
      required:
        - code
        - name_1
        - unit_cost
        - item_type
        - tax_type
    Dealer:
      type: object
      properties:
        code:
          type: string
          description: รหัสตัวแทนจำหน่าย
          maxLength: 25
        name_1:
          type: string
          description: ชื่อ
          maxLength: 25
        name_eng_1:
          type: string
          description: ชื่อ(อังกฤษ)
          maxLength: 25
        tambon_code:
          type: string
          description: รหัสตำบล
          maxLength: 25
        amper_code:
          type: string
          description: รหัสอำเภอ
          maxLength: 25
        province_code:
          type: string
          description: รหัสจังหวัด
          maxLength: 25
    ProductUnit:
      type: object
      properties:
        code:
          type: string
          description: รหัสหน่วยนับ
          maxLength: 25
        line_number:
          type: integer
          description: Line Number
        stand_value:
          type: number
          description: ตัวตั้ง
        divide_value:
          type: number
          description: ตัวหาร
        row_order:
          type: integer
          description: ลำดับที่
        weight:
          type: string
          description: น้ำหนัก
          example: 200 g.
        status:
          type: integer
          description: สถานะ
        unit_size:
          type: number
          description: ขนาดสินค้า
        ratio:
          type: number
          description: อัตราส่วน
        width_length_height:
          type: string
          maxLength: 255
          example: กxยxส
        remark:
          type: string
          description: หมายเหตุ
      required:
        - code
        - stand_value
        - divide_value
        - row_order
        - line_number
    Barcode:
      type: object
      properties:
        barcode:
          type: string
          description: บาร์โค๊ด
          maxLength: 25
        unit_code:
          type: string
          description: รหัสหน่วยนับ
          maxLength: 25
        price:
          type: number
          description: ราคา
      required:
        - barcode
        - unit_code
    Unit:
      type: object
      properties:
        code:
          type: string
          maxLength: 25
          description: ขนาดสินค้า
        name_1:
          type: string
          maxLength: 25
          description: ขนาดสินค้า
        name_eng_1:
          type: string
          maxLength: 25
          description: ขนาดสินค้า
    ProductDealer:
      type: object
      properties:
        productcode:
          type: string
          maxLength: 25
          description: รหัสสินค้า
        dealers:
          type: array
          items:
            $ref: '#/components/schemas/ProductDealerSync'
    ProductDealerSync:
      type: object
      properties:
        dealercode:
          type: string
          maxLength: 25
          description: รหัสตัวแทนจำหน่าย
        issync:
          type: boolean
          description: อนุญาติให้ใช้งาน
    Transaction:
      type: object
      properties:
        dealercode:
          type: string
        docno:
          type: string
        docdate:
          type: string
          format: date
        doctime:
          type: string
          example: "00:00:00"
        taxdocno:
          type: string
        taxdocdate:
          type: string
          format: date
        custcode:
          type: string
        custname:
          type: string        
        vattype:
          type: integer
          description: ประเภทภาษี(0=ภาษีแยกนอก, 1=ยกเว้นภาษี)
        varrate:
          type: number
        # salecode:
        #   type: string
        # salename:
        #   type: string
        totalvalue:
          type: number
        discountword:
          type: string
        totaldiscount:
          type: number
        totalbeforevat:
          type: number
        totalvatvalue:
          type: number
        totalexceptvat:
          type: number
        items:
          type: array
          items:
            $ref: '#/components/schemas/TransactionItem'
    TransactionItem:
      properties:
        line_number:
          type: integer
        itemcode:
          type: string
        itemname:
          type: string
        unitcode:
          type: string
        unitname:
          type: string
        qty:
          type: number
        price:
          type: number
        discount:
          type: string
        discountamount:
          type: number
        sumamount:
          type: number
        item_tax_type:
          type: integer
          description: ประเภทภาษี(0=มีภาษี, 1=ยกเว้นภาษี)
        sumamountexcludevat:
          type: number
        warehouse:
          type: string
        warehouse_name:
          type: string
        location:
          type: string
        location_name:
          type: string
    Payment:
      type: object
      properties:
        cashamount:
          type: number
        creditcardamount:
          type: number
        chequeamount:
          type: number
        transferamount:
          type: number
        creditcarddetail:
          type: array
          items:
            $ref: '#/components/schemas/CreditCardPayment'
        transferdetail:
          type: array
          items:
            $ref: '#/components/schemas/TransferPayment'
        chequqdetail:
          type: array
          items:
            $ref: '#/components/schemas/ChequePayment'
    CreditCardPayment:
      type: object
      properties:
        cardnumber:
          type: string
        approvedcode:
          type: string
        creditcardtype:
          type: string
        amount:
          type: number
        chargeamount:
          type: number
        totalamount:
          type: number
    TransferPayment:
      type: object
      properties:
        transferdate:
          type: string
          format: date
        bankcode:
          type: string
        bankname:
          type: string
        bankbranchcode:
          type: string
        bankbranchname:
          type: string
        amount:
          type: number
    ChequePayment:
      type: object
      properties:
        chequeno:
          type: string
        chequeduedate:
          type: string
          format: date
        bankcode:
          type: string
        bankname:
          type: string
        bankbranchcode:
          type: string
        bankbranchname:
          type: string
        amount:
          type: number
    SaleInvoiceTransaction:
      type: object
      allOf:
        - $ref: '#/components/schemas/Transaction'
      properties:
        saletype:
          type: integer
          description: ประเภทการขาย(1=ขายเชื่อ, 1=ขายเงินสด, 2=ขายเชื่อ/สินค้าบริการ , 3=ขายสด/สินค้าบริการ )
        payment:
          $ref: '#/components/schemas/Payment'
    TransactionWithPayment:
      type: object
      allOf:
        - $ref: '#/components/schemas/Transaction'
      properties:
        payment:
          $ref: '#/components/schemas/Payment'
  securitySchemes:
    bearer_token:      
      type: http
      scheme: bearer      
      bearerFormat: Bearer <token>
    api_key:
      type: apiKey
      name: x-api-key
      in: header
        